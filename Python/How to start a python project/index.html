
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.5">
    
    
      
        <title>How to start a project - S3rius' Dev Notes</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.77f3fd56.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/highlight_style.css">
    
      <link rel="stylesheet" href="../../termynal.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#how-to-start-a-project" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="S3rius&#39; Dev Notes" class="md-header__button md-logo" aria-label="S3rius' Dev Notes">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            S3rius' Dev Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              How to start a project
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
        <div class="md-select">
          
          <span class="md-header__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.87 15.07l-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>
          </span>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="/en/" class="md-select__link">
                    üá¨üáß English
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="/ru/" class="md-select__link">
                    üá∑üá∫ –†—É—Å—Å–∫–∏–π
                  </a>
                </li>
                
            </ul>
          </div>
        </div>
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/s3rius/obsidian" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    s3rius/obsidian
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Welcome
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../DevOps/" class="md-tabs__link">
        DevOps
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Python
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="S3rius&#39; Dev Notes" class="md-nav__button md-logo" aria-label="S3rius' Dev Notes">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    S3rius' Dev Notes
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/s3rius/obsidian" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    s3rius/obsidian
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        DevOps
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="DevOps" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          DevOps
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../DevOps/" class="md-nav__link">
        DevOps notes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../DevOps/Docker%20envs%20separation/" class="md-nav__link">
        Separating docker envs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../DevOps/Makefiles%20for%20dummies/" class="md-nav__link">
        Makefiles for dummies
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Python
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Python" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Python notes
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          How to start a project
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        How to start a project
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-deal-with-poetry" class="md-nav__link">
    How to deal with poetry
  </a>
  
    <nav class="md-nav" aria-label="How to deal with poetry">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dependency-management" class="md-nav__link">
    Dependency management
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-commands" class="md-nav__link">
    Running commands
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#versioning" class="md-nav__link">
    Versioning
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyprojecttoml" class="md-nav__link">
    pyproject.toml
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packaging-and-publishing-on-pypi" class="md-nav__link">
    Packaging and publishing on pypi
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-deal-with-poetry" class="md-nav__link">
    How to deal with poetry
  </a>
  
    <nav class="md-nav" aria-label="How to deal with poetry">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dependency-management" class="md-nav__link">
    Dependency management
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-commands" class="md-nav__link">
    Running commands
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#versioning" class="md-nav__link">
    Versioning
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyprojecttoml" class="md-nav__link">
    pyproject.toml
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packaging-and-publishing-on-pypi" class="md-nav__link">
    Packaging and publishing on pypi
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="how-to-start-a-project">How to start a project<a class="headerlink" href="#how-to-start-a-project" title="Permanent link">&para;</a></h1>
<p>You have several options. For example, you can store a bunch of <code>.py</code> files in a repo on the Github and be fully satisfied, or you can add the <code>setup.py</code> script and publish it on the PyPI, but the best option as I can see is to start and develop your project with poetry.</p>
<p>Why?</p>
<p><code>Poetry</code> has many features. I'm here to tell you about them, and how to use them, and what to do.</p>
<p>Let's create a project with poetry.</p>
<p></p>
<div class="termy" data-termynal>
<span data-ty="input">poetry new new_proj</span>
<span data-ty>Created package new_proj in new_proj</span>
<span data-ty="input">cd new_proj</span>
<span data-ty></span>
</div>

<p>This command generates a project with the following structure:</p>
<pre><code>new_proj
‚îú‚îÄ‚îÄ new_proj
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ pyproject.toml
‚îú‚îÄ‚îÄ README.rst
‚îî‚îÄ‚îÄ tests
    ‚îú‚îÄ‚îÄ __init__.py
    ‚îî‚îÄ‚îÄ test_new_proj.py
</code></pre>
<p>It's our brand new project with several stubs. There is nothing unusual. All the code you want to write will be placed in a directory with the same name as the project. <code>README.rst</code> is the default README. <code>pyproject.toml</code> contains meta-data about the project, such as dependencies, description, extra installation options, and more. You can read about <code>pyproject.toml</code> <a href="https://python-poetry.org/docs/pyproject/">here</a>.</p>
<h2 id="how-to-deal-with-poetry">How to deal with poetry<a class="headerlink" href="#how-to-deal-with-poetry" title="Permanent link">&para;</a></h2>
<p>All the information you need you can find in official documentation poetry. I'll tell you about basic stuff here.</p>
<h3 id="dependency-management">Dependency management<a class="headerlink" href="#dependency-management" title="Permanent link">&para;</a></h3>
<p>To add a dependency to your project you can simply run this:</p>
<p></p>
<div class="termy" data-termynal>
<span data-ty="input">poetry add ${dependency}</span>
<span data-ty></span>
</div>

<p>This command finds the last convenient version of the dependency and writes it to the <code>pyproject.toml</code> and <code>poetry.lock</code>.</p>
<p>To add dependency only for development, such as linters or formatters,
you can add the <code>--dev</code> flag.</p>
<p></p>
<div class="termy" data-termynal>
<span data-ty="input">poetry add ${dependency} --dev </span>
<span data-ty></span>
</div>

<p>To remove dependency you simply need to replace <code>add</code> with <code>remove</code>.</p>
<p>Working example:</p>
<p></p>
<div class="termy" data-termynal>
<span data-ty="input">poetry add loguru   </span>
<span data-ty>Using version ^0.5.3 for loguru  </span>
<span data-ty></span>
<span data-ty>Updating dependencies  </span>
<span data-ty>Resolving dependencies... (0.1s)  </span>
<span data-ty></span>
<span data-ty>Writing lock file</span>
<span data-ty></span>
<span data-ty>Package operations: 1 install, 0 updates, 0 removals  </span>
<span data-ty>¬†‚Ä¢ Installing loguru (0.5.3)</span>
<span data-ty="input">poetry remove loguru</span>
<span data-ty>Updating dependencies</span>
<span data-ty>Resolving dependencies... (0.1s)</span>
<span data-ty></span>
<span data-ty>Writing lock file</span>
<span data-ty></span>
<span data-ty>Package operations: 0 installs, 0 updates, 1 removal  </span>
<span data-ty>¬†‚Ä¢ Removing loguru (0.5.3)</span>
<span data-ty></span>
</div>

<h3 id="running-commands">Running commands<a class="headerlink" href="#running-commands" title="Permanent link">&para;</a></h3>
<p>In a virtual environment you need to write something like this, to enter the shell:</p>
<pre><code class="language-bash">source venv/bin/activate
</code></pre>
<p>But with poetry, it's much easier. It creates and manages virtual environments on its own. To run a single command you can call <code>run</code>. </p>
<p>E.G.:</p>
<p></p>
<div class="termy" data-termynal>
<span data-ty="input">poetry install black --dev</span>
<span data-ty>Using version ^20.8b1 for black   </span>
<span data-ty> ‚Ä¢ Installing appdirs (1.4.4)  </span>
<span data-ty>¬†‚Ä¢ Installing click (7.1.2)  </span>
<span data-ty>¬†‚Ä¢ Installing mypy-extensions (0.4.3)  </span>
<span data-ty>¬†‚Ä¢ Installing pathspec (0.8.1)  </span>
<span data-ty>¬†‚Ä¢ Installing regex (2020.11.13)  </span>
<span data-ty>¬†‚Ä¢ Installing toml (0.10.2)  </span>
<span data-ty>¬†‚Ä¢ Installing typed-ast (1.4.2)  </span>
<span data-ty>¬†‚Ä¢ Installing typing-extensions (3.7.4.3)  </span>
<span data-ty>¬†‚Ä¢ Installing black (20.8b1)</span>
<span data-ty="input">poetry run black .</span>
<span data-ty>reformatted new_proj/new_proj/__init__.py</span>
<span data-ty>reformatted new_proj/tests/test_new_proj.py</span>
<span data-ty>All done! ‚ú® üç∞ ‚ú®</span>
<span data-ty>2 files reformatted, 1 file left unchanged.</span>
<span data-ty></span>
</div>

<p>For executing multiple commands within the shell you can enter an interactive shell session with <code>poetry shell</code>. It's similar to virtualenv's <code>source venv/bin/activate</code>.</p>
<p></p>
<div class="termy" data-termynal>
<span data-ty="input">poetry shell</span>
<span data-ty>Spawning shell within /home/s3rius/.cache/pypoetry/virtualenvs/new-proj-eutP4v0O-py3.9</span>
<span data-ty="input">black .</span>
<span data-ty>reformatted new_proj/new_proj/__init__.py</span>
<span data-ty>reformatted new_proj/tests/test_new_proj.py</span>
<span data-ty>All done! ‚ú® üç∞ ‚ú®</span>
<span data-ty>2 files reformatted, 1 file left unchanged.</span>
<span data-ty></span>
</div>

<h3 id="versioning">Versioning<a class="headerlink" href="#versioning" title="Permanent link">&para;</a></h3>
<p>With poetry, you don't need to change package versions manually.</p>
<p>The Poetry has something for you.</p>
<p></p>
<div class="termy" data-termynal>
<span data-ty="input">poetry version patch</span>
<span data-ty>Bumping version from 0.1.0 to 0.1.1</span>
<span data-ty="input">poetry version preminor</span>
<span data-ty>Bumping version from 0.1.1 to 0.2.0-alpha.0</span>
<span data-ty="input">poetry version minor   </span>
<span data-ty>Bumping version from 0.2.0-alpha.0 to 0.2.0</span>
<span data-ty="input">poetry version premajor</span>
<span data-ty>Bumping version from 0.2.0 to 1.0.0-alpha.0</span>
<span data-ty="input">poetry version major   </span>
<span data-ty>Bumping version from 1.0.0-alpha.0 to 1.0.0</span>
<span data-ty></span>
</div>

<h2 id="pyprojecttoml">pyproject.toml<a class="headerlink" href="#pyprojecttoml" title="Permanent link">&para;</a></h2>
<p>As mentioned before this file contains the package's meta-information.</p>
<p>Example of <code>pyproject.toml</code></p>
<pre><code class="language-toml">[tool.poetry]
name = &quot;new_proj&quot;
version = &quot;0.1.0&quot;
description = &quot;Test library for example&quot;
readme = &quot;README.rst&quot;
homepage = &quot;https://test_url.com/&quot;
repository = &quot;https://github.meme/&quot;
authors = [&quot;Pavel Kirilin &lt;win10@list.ru&gt;&quot;]

[tool.poetry.dependencies]
python = &quot;^3.8&quot;

[tool.poetry.dev-dependencies]
pytest = &quot;^6.1&quot;

[build-system]
requires = [&quot;poetry-core&gt;=1.0.0&quot;]
build-backend = &quot;poetry.core.masonry.api&quot;
</code></pre>
<p>To install all dependencies simply run:</p>
<p></p>
<div class="termy" data-termynal>
<span data-ty="input">poetry install</span>
<span data-ty></span>
</div>

<p>This command creates a virtual environment and installs dependencies from the <code>pyproject.toml</code> file. If you want to install dependencies only for the runtime you can add <code>--no-dev</code>.</p>
<h2 id="packaging-and-publishing-on-pypi">Packaging and publishing on pypi<a class="headerlink" href="#packaging-and-publishing-on-pypi" title="Permanent link">&para;</a></h2>
<p>It's really simple. </p>
<p>Let's add a function to the project.</p>
<pre><code class="language-python"># new_proj/main.py
def ab_problem(a: int, b: int) -&gt; int:
    return a + b
</code></pre>
<pre><code class="language-python"># new_proj/__init.py
from new_proj.main import ab_problem

__all__ = [
    'ab_problem'
]
</code></pre>
<p>Now you can build the project.</p>
<p></p>
<div class="termy" data-termynal>
<span data-ty="input">poetry build</span>
<span data-ty>Building new_proj (0.1.0)</span>
<span data-ty>  - Building sdist</span>
<span data-ty>  - Built new_proj-0.1.0.tar.gz</span>
<span data-ty>  - Building wheel</span>
<span data-ty>  - Built new_proj-0.1.0-py3-none-any.whl</span>
<span data-ty></span>
</div>

<p>You can find ready for publication package in <code>dist/</code> folder.
Let's check if everything works.</p>
<p></p>
<div class="termy" data-termynal>
<span data-ty="input">pip install &quot;./dist/new_proj-0.1.0-py3-none-any.whl&quot;  </span>
<span data-ty>Processing ./dist/new_proj-0.1.0-py3-none-any.whl</span>
<span data-ty>Installing collected packages: new-proj</span>
<span data-ty>Successfully installed new-proj-0.1.0</span>
<span data-ty></span>
<span data-ty="input">python</span>
<span data-ty>Python 3.9.1 (default, Feb  1 2021, 04:02:33) </span>
<span data-ty>[GCC 10.2.0] on linux</span>
<span data-ty>Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span>
<span data-ty="input">from new_proj import ab_problem</span>
<span data-ty="input">ab_problem(1,33)</span>
<span data-ty>34</span>
<span data-ty></span>
</div>

<p>It works! Now we can use it.</p>
<p>If you want to publish the package you can run:</p>
<p></p>
<div class="termy" data-termynal>
<span data-ty="input">poetry publish -u &quot;user&quot; -p &quot;password&quot;</span>
<span data-ty></span>
</div>

<p>More information you can find <a href="https://python-poetry.org/docs/cli/#publish">here</a>.</p>
<h1 id="configuring-project">Configuring project<a class="headerlink" href="#configuring-project" title="Permanent link">&para;</a></h1>
<p>A project without configuration is a bad thing. Let's configure the development environment.</p>
<p></p>
<div class="termy" data-termynal>
<span data-ty="input">poetry add \</span>
<span data-ty="input">  flake8 \</span>
<span data-ty="input">  black \</span>
<span data-ty="input">  isort \</span>
<span data-ty="input">  mypy \</span>
<span data-ty="input">  pre-commit \</span>
<span data-ty="input">  yesqa \</span>
<span data-ty="input">  autoflake \</span>
<span data-ty="input">  wemake-python-styleguide --dev</span>
<span data-ty="progress"></span>
<span data-ty></span>
</div>

<p>Now we need to add configuration files for linters and formatters.
This is my preferred configuration, you can change it as you wish.</p>
<p><code>.mypy.ini</code> for types validation.</p>
<pre><code class="language-ini">[mypy]
strict = True
ignore_missing_imports=True
allow_subclassing_any=True
allow_untyped_calls=True
pretty=True
show_error_codes=True
implicit_reexport=True
allow_untyped_decorators=True
</code></pre>
<p><code>.isort.cfg</code> for import sorting.</p>
<pre><code class="language-ini">[isort]
multi_line_output = 3
include_trailing_comma = true
use_parentheses = true
</code></pre>
<p><code>.flake8</code> - Linter configuration. The biggest part of the document is ignore statements for errors that are not errors.</p>
<pre><code class="language-ini">[flake8]
max-complexity = 6
inline-quotes = double
max-line-length = 88
extend-ignore = E203
docstring_style=sphinx

ignore =
  ; Found `f` string
  WPS305,
  ; Missing docstring in public module
  D100,
  ; Missing docstring in magic method
  D105,
  ; Missing docstring in __init__
  D107,
  ; Found class without a base class
  WPS306,
  ; Missing docstring in public nested class
  D106,
  ; First line should be in imperative mood
  D401,
  ; Found `__init__.py` module with logic
  WPS412,
  ; Found implicit string concatenation
  WPS326,
  ; Found string constant over-use
  WPS226,
  ; Found upper-case constant in a class
  WPS115,
  ; Found nested function
  WPS430,
  ; Found using `@staticmethod`
  WPS602,
  ; Found method without arguments
  WPS605,
  ; Found overused expression
  WPS204,
  ; Found too many module members
  WPS202,
  ; Found too high module cognitive complexity
  WPS232,
  ; line break before binary operator
  W503,
  ; Found module with too many imports
  WPS201,
  ; Found vague import that may cause confusion: X
  WPS347,
  ; Inline strong start-string without end-string.
  RST210,
  ; subprocess call with shell=True seems safe, but may be changed in the future.
  S602,
  ; Starting a process with a partial executable path.
  S607,
  ; Consider possible security implications associated with subprocess module.
  S404,
  ; Found nested class
  WPS431,
  ; Found wrong module name
  WPS100,
  ; Found too many methods
  WPS214,
  ; Found too long ``try`` body
  WPS229,
  ; Found function with too much cognitive complexity
  WPS231,

  ; all init files
  __init__.py:
  ; ignore not used imports
  F401,
  ; ignore import with wildcard
  F403,
  ; Found wrong metadata variable
  WPS410,

per-file-ignores =
  ; all tests
  test_*.py,tests.py,tests_*.py,*/tests/*:
  ; Use of assert detected
  S101,

exclude =
  ./.git,
  ./venv,
  ./cached_venv,
  ./var,
</code></pre>
<p><code>.pre-commit-config.yaml</code> - Git hooks configuration. To perform all checks right before <code>git commit</code>.</p>
<pre><code class="language-yaml"># See https://pre-commit.com for more information
# See https://pre-commit.com/hooks.html for more hooks
repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v2.4.0
    hooks:
      - id: check-ast
      - id: trailing-whitespace
      - id: check-toml
      - id: end-of-file-fixer

  - repo: https://github.com/asottile/add-trailing-comma
    rev: v2.1.0
    hooks:
    -   id: add-trailing-comma

  - repo: local
    hooks:
      - id: black
        name: Format with Black
        entry: black
        language: system
        types: [python]

      - id: autoflake
        name: autoflake
        entry: autoflake
        language: system
        types: [ python ]
        args: [ --in-place, --remove-all-unused-imports, --remove-duplicate-keys ]

      - id: isort
        name: isort
        entry: isort
        language: system
        types: [ python ]

      - id: flake8
        name: Check with Flake8
        entry: flake8
        language: system
        pass_filenames: false
        types: [ python ]
        args: [--count, .]

      - id: mypy
        name: Validate types with MyPy
        entry: mypy
        language: system
        types: [ python ]

      - id: yesqa
        name: Remove usless noqa
        entry: yesqa
        language: system
        types: [ python ]

      - id: pytest
        name: pytest
        entry: pytest
        language: system
        pass_filenames: false
        types: [ python ]
</code></pre>
<p>Don't forget to add <code>.gitignore</code>. You can find it <a href="https://github.com/github/gitignore/blob/master/Python.gitignore">here</a>.</p>
<p>It' VERY IMPORTANT for correct work of pre-commit.</p>
<p>Now we can install hooks.</p>
<p></p>
<div class="termy" data-termynal>
<span data-ty="input">git init</span>
<span data-ty>Initialized empty Git repository in .git/</span>
<span data-ty="input">poetry shell</span>
<span data-ty="input">pre-commit install</span>
<span data-ty>pre-commit installed at .git/hooks/pre-commit</span>
<span data-ty="input">git commit</span>
<span data-ty>... # It will have a lot of errors.</span>
<span data-ty></span>
</div>

<p>Let's fix it.</p>
<p>At first we need to fix tests.</p>
<p>In <code>tests/test_new_proj.py</code> add this:</p>
<pre><code class="language-python">from new_proj import ab_problem


def test_ab() -&gt; None:
    &quot;&quot;&quot;AB problecm success case.&quot;&quot;&quot;
    assert ab_problem(1, 2) == 3
</code></pre>
<p>Add a description in <code>__init__</code> files.
<code>tests/__init__.py</code>:</p>
<pre><code class="language-python">&quot;&quot;&quot;Tests for new_proj.&quot;&quot;&quot;
</code></pre>
<p><code>new_proj/__init__.py</code>:</p>
<pre><code class="language-python">&quot;&quot;&quot;Project for solving ab problem.&quot;&quot;&quot;
from new_proj.main import ab_problem

__all__ = [
    &quot;ab_problem&quot;,
]
</code></pre>
<p>Fix the main file of a project.</p>
<p><code>new_proj/main.py</code>:</p>
<pre><code class="language-python">def ab_problem(first: int, second: int) -&gt; int:
    &quot;&quot;&quot;
    Solve AB problem.

    The function sums two integers.

    :param first: a argument.
    :param second: b argument.
    :returns: sum.
    &quot;&quot;&quot;
    return first + second
</code></pre>
<p>Now you can commit without errors.</p>
<p></p>
<div class="termy" data-termynal>
<span data-ty="input">git commit     </span>
<span data-ty>Check python ast................Passed</span>
<span data-ty>Trim Trailing Whitespace........Passed</span>
<span data-ty>Check Toml......................Passed</span>
<span data-ty>Fix End of Files................Passed</span>
<span data-ty>Add trailing commas.............Passed</span>
<span data-ty>Format with Black...............Passed</span>
<span data-ty>autoflake.......................Passed</span>
<span data-ty>isort...........................Passed</span>
<span data-ty>Check with Flake8...............Passed</span>
<span data-ty>Validate types with MyPy........Passed</span>
<span data-ty>Remove usless noqa..............Passed</span>
<span data-ty>pytest..........................Passed</span>
<span data-ty></span>
</div>

<p>Now you know how to create a masterpiece.</p>
<h1 id="creating-cli-tool">Creating CLI tool<a class="headerlink" href="#creating-cli-tool" title="Permanent link">&para;</a></h1>
<p>What if I want to create a CLI-tool?
It is easier than you think.</p>
<p>Let's modify our main file.</p>
<pre><code class="language-python">import argparse


def parse_args() -&gt; argparse.Namespace:
    &quot;&quot;&quot;
    Parse CLI arguments.

    :returns: parsed namespace.
    &quot;&quot;&quot;
    parser = argparse.ArgumentParser()

    parser.add_argument(&quot;a&quot;, type=int)
    parser.add_argument(&quot;b&quot;, type=int)

    return parser.parse_args()


def ab_problem(first: int, second: int) -&gt; int:
    &quot;&quot;&quot;
    Solve AB problem.

    The function sums two integers.

    :param first: a argument.
    :param second: b argument.
    :returns: sum.
    &quot;&quot;&quot;
    return first + second


def main() -&gt; None:
    &quot;&quot;&quot;Main function.&quot;&quot;&quot;
    args = parse_args()
    print(ab_problem(args.a, args.b))  # noqa: WPS421

</code></pre>
<p>Now we need to change the <code>pyproject.toml</code>. Add the following section somewhere in <code>pyproject.toml</code>.</p>
<pre><code class="language-toml">[tool.poetry.scripts]
ab_solver = &quot;new_proj.main:main&quot;
</code></pre>
<p>Now you can use the <code>ab_solver</code> in your terminal.</p>
<p></p>
<div class="termy" data-termynal>
<span data-ty="input">poetry install</span>
<span data-ty="input">poetry shell</span>
<span data-ty="input">ab_solver 1 2</span>
<span data-ty>3</span>
<span data-ty></span>
</div>

<p>Do you want to install it globally in the system? Here you go.</p>
<p></p>
<div class="termy" data-termynal>
<span data-ty="input">poetry build</span>
<span data-ty>Building new_proj (0.1.0)</span>
<span data-ty>  - Building sdist</span>
<span data-ty>  - Built new_proj-0.1.0.tar.gz</span>
<span data-ty>  - Building wheel</span>
<span data-ty>  - Built new_proj-0.1.0-py3-none-any.whl</span>
<span data-ty="input">pip install &quot;./dist/new_proj-0.1.0-py3-none-any.whl&quot;</span>
<span data-ty>Processing ./dist/new_proj-0.1.0-py3-none-any.whl</span>
<span data-ty>Installing collected packages: new-proj</span>
<span data-ty>Successfully installed new-proj-0.1.0</span>
<span data-ty="input">ab_solver 1 2                                     </span>
<span data-ty>3</span>
<span data-ty></span>
</div>

<p>If you publish your project in <code>PyPi</code> or anywhere else, users who install your program get it as the CLI-tool.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Python notes
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "navigation.tabs"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.5cf3e710.min.js"></script>
      
        <script src="../../js/highlight.min.js"></script>
      
        <script src="../../js/startup.js"></script>
      
        <script src="../../termynal.js"></script>
      
    
  </body>
</html>